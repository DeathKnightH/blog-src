# 工厂方法
## 1. 概念
工厂方法（Factory Method）又称虚拟构造函数，是一种`创建型模式`。

## 2. 意图
在父类中提供一个创建对象的接口，由子类决定创建什么类型的对象，即把实例化推迟到子类进行。

## 3. 类图示例
![FactoryMethod](../../resource/design_pattern/factorymethod.drawio.png)

如图所示：
* Product：产品类的顶层接口，是工厂方法的返回类型，其中定义了所有业务相关的操作接口，供 `Creator` 业务逻辑使用。
* Concrete Products：具体的产品类实现。
* **Creator**：
  * 工厂方法声明的地方，图中 `createProduct()` 方法就是工厂方法，这个方法通常是 `abstract` 的，返回的类型必须是 `Product` 的顶层接口类型。
  * `Creator` 本身一般不负责创建 `Product`，而是由 `Creator` 的不同子类通过实现不同的 `createProduct()` 方法来创建具体的 `Product`。而 `Creator` 自身通常是实现具体 `Product` 相关业务操作的地方。
* Concrete Creators：具体的工厂方法实现类，通常只负责创建具体的产品实例。在实际开发中，不用每次调用都创建新的实例，可以用缓存/对象池/单例来实现。

## 4. 适用场景
### 4.1 业务场景
* 当不确定一个对象的具体类型，可以将创建对象的代码替换为工厂方法。
* 如果可以确定某个组件或者对象未来一定会扩展出新的类别，也可以提前将这个对象的创建抽象为一个工厂方法。

### 4.2 开源实例
JDK 中：
* java.util.Calendar
* java.util.ResourceBundle
* java.nio.charset.Charset
* java.util.EnumSet

## 5. 实现细节和技巧
* 工厂方法构造的产品对象必须实现同一个 `interface`。
* 统一的产品 `interface` 必须包含所有在产品使用过程中会调用的主要方法。
* 如果产品对象具体类型太多可以尝试为产品子类创建子类，复用一部分共用的构造逻辑。
* 如果具体的产品对象过于复杂，内部对象层次和组合很多，可以尝试改为使用生成器模式。

## 6. 优缺点
优点：
* 解耦业务逻辑和具体产品。
* 符合单一职责原则。将创建产品对象的代码放在一个单一的位置。
* 符合开闭原则。无需修改业务逻辑代码，就可以通过新增产品子类来扩展产品类型。

缺点：
* 使用工厂模式会引入很多新的接口和子类，使代码结构变复杂，但这属于工程组织结构的问题了，需要设计模式外的工具方法解决。

## 7. 和其他模式的关系
### 7.1 和其他“工厂”对比
[几个名字带“工厂”的创建型模式对比](./几种“工厂”之间的区别.md)

### 7.2 和其他创建型模式的关系
* 和单例模式没什么关系。
* 工厂方法实现起来较简单，复杂起来可以演化为抽象工厂模式、原型模式或者生成器模式。

### 7.3 和其他非创建型模式的关系
