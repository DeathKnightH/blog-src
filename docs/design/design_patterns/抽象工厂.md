# 抽象工厂
## 1. 概念
`Abstract Factory` 是一种`创建型模式`，用来创建一系列相关的对象。

## 2. 意图
提供一个接口/抽象类，用于创建一组互相有关联的对象家族（多个对象）。

## 3. 类图示例
![abstractfactory](../../resource/design_pattern/abstractfactory.drawio.png)

如图：
* Client：业务逻辑实现的代指，使用 AbstractFactory 创建需要的一系列对象。
* AbstractFactory：抽象工厂本身真的是一个抽象类/接口，一般不负责具体的业务逻辑，只提供一系列抽象对象的创建接口。
* ProductA/ProductB：抽象产品，是构成一系列产品的一组不同但相关（这里相关可以简单理解为一系列，比如椅子和沙发同属家具这一系列）的产品声明接口。
* ConcreteFactory1/ConcreteFactory2：创建具体产品对象的工厂实现类，但是返回的类型必须是**抽象**产品，这样才能实现具体产品类型和业务逻辑的解耦。
* ConcreteProductA1/ConcreteProductA2/ConcreteProductB1/ConcreteProductB2：具体产品，图中同一个序号的产品属于同一系列，分为了两个系列的产品组，ConcreteFactory1 负责生产 1 系列产品， ConcreteFactory2 负责生产 2 系列产品。

## 4. 应用场景
### 4.1 业务场景
* 代码需要与多个不同体系的产品进行交互，比如要用同一组通信协议对接不同的运营商实现。
* 代码中有基于一组工厂方法的类，又包含一些业务逻辑操作，可以把这些工厂方法抽取到独立的抽象工厂类中去。

### 4.2 开源实例
JDK 中：
* javax.xml.parsers.DocumentBuilderFactory

## 5. 实现细节和技巧
* 在写代码之前先梳理产品类型，如果能形成体系+类型的矩阵，就可以继续按照抽象工厂模式进行设计和编码。
* 每一种产品都需要定义接口。
* 为每一个体系的产品定义一个具体工厂。

## 6. 优缺点
优点：
* 确保一系列对象类型互相匹配。
* 解耦业务代码和具体产品对象的代码。
* 符合单一职责原则。
* 符合开闭原则。

缺点：
* 引入产品接口和抽象工厂，类的数量大大增多了，代码组织结构更复杂了。

## 7. 和其他设计模式的关系
### 7.1 和其他“工厂”对比
[几个名字带“工厂”的创建型模式对比](./几种“工厂”之间的区别.md)

### 7.2 和其他创建型模式的关系
* 抽象工厂通常基于一组工厂方法演化而来。
* 抽象工厂可以用单例模式来实现。

### 7.3 和其他非创建型模式的关系
